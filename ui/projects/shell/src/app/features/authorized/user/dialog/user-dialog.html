<form class="flex flex-col gap-2" [formGroup]="formGroup">

    <div class="flex flex-col">
        <label for="username">{{'person.username'|translate}}</label>
        <input id="username" pInputText formControlName="username" />
    </div>
    @if(isNew()) {
    <div class="flex flex-col">
        <label for="password">{{'label.password'|translate}}</label>
        <p-password inputStyleClass="w-full" inputId="password" formControlName="password" [feedback]="false"
            [toggleMask]="true" />
    </div>
    }
    <div class="flex flex-col">
        <label for="firstname">{{'person.firstname'|translate}}</label>
        <input id="firstname" pInputText formControlName="firstname" />
    </div>
    <div class="flex flex-col">
        <label for="lastname">{{'person.lastname'|translate}}</label>
        <input id="lastname" pInputText formControlName="lastname" />
    </div>

    <div class="flex flex-col min-w-[300px]">
        <label for="roles">{{'roles.plural'|translate}}</label>
        <p-multiselect [filter]="false" appendTo="body" inputId="roles" [options]="roleStore.roles.value().items"
            formControlName="roles" optionLabel="name" placeholder="Select Roles" class="w-full">
            <ng-template let-items #selecteditems>
                <div class="flex gap-1">
                    @for(item of items; track item) {
                    <app-role [role]="item.name" />
                    }
                </div>
            </ng-template>
            <ng-template let-item #item>
                <app-role [role]="item.name" />
            </ng-template>
        </p-multiselect>
    </div>

    <div class="flex flex-col min-w-[300px]">
        <label for="brokers">{{'blaudirekt.broker.plural'|translate}}</label>
        <p-multiselect [filter]="false" appendTo="body" inputId="brokers" [options]="brokerStore.brokers.value().items"
            formControlName="brokers" optionLabel="name"
            [placeholder]="'utils.select.value'|translate:{value:'blaudirekt.broker.plural'|translate}" class="w-full">

        </p-multiselect>
    </div>

    <div class="flex flex-col min-w-[300px]">
        <label for="users">{{'auth.user.label'|translate}}</label>
        <p-multiselect [filter]="false" appendTo="body" inputId="users" [options]="userStore.users()"
            formControlName="users" optionLabel="username"
            [placeholder]="'utils.select.value'|translate:{value:'auth.user.label'|translate}" class="w-full">
            <ng-template #selecteditems let-item>
                <div class="flex flex-wrap gap-1">
                    @for(name of item; track name; let last = $last) {
                    <span>{{name.username}}</span>
                    @if(!last) {
                    ,
                    }
                    }
                </div>
            </ng-template>
        </p-multiselect>
    </div>
</form>
<p-divider />
<div class="flex justify-end">
    <p-button (onClick)="close()" label="Speichern" />
</div>